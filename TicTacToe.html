<html>
    <head>
        <meta charset="utf-8" />
        <title>Tic Tac Toe</title> 
        
        <style>
            body {
              background-color: rgb(126, 193, 216);
            }
            
            h1 {
              color: rgb(12, 11, 11);
              text-align: center;
              font-size: 80px;
            }
            
            p {
              font-family: sans-serif;
              font-size: 25px;
            }
            .board {
                
                border: 5px outset rgb(8, 87, 235);
                background-color: rgb(8, 87, 235);
               
            }
            img { /* we will add the css for the single boards element here*/
                border: 3px solid black;
            }

            </style>

    </head>
    
    <body>
        <script>

        let round=0 //the variable round is used by the bot to chose the best move
        var board =[    
        [0,0,0],
        [0,0,0],
        [0,0,0]
        ]

    function drawBoard() {  //function that put into the table every single element of the array board
        board.forEach((row, i) => 
        row.forEach((item, j) => {
            if(item >0 ) { 
                if(item==1) item= "<img src='https://png.monster/wp-content/uploads/2022/01/png.monster-456-370x280.png' alt='amogus' height=80 width=80>"
                else item="<img src='https://www.transparentpng.com/thumb/red-circle/classic-border-red-circle-free-png-x2X5ZG.png' height=80 width=80>"
            
            document.getElementById("cell" + i + j).innerHTML = item
            }   
        
        })
        )
        theWinner() //check the result of the game
    }
    function IA() {
    if(round==1) {

            if(board[1][1]== 0 ) board[1][1]=2 
            else board[2][0]=2; // if the other corner is not free, the second best choice is to pick the center(we have won)     
    }
    else if (round == 2) {
            if(board[1][1]==2) { //the bot has the center
                if(board[0][0]==1) {
                    //[1,?,?],
                    //[?,2,?],
                    //[?,?,?]  
                    if(board[0][2] == 1)board[0][1]=2
                    else if(board[2][0] == 1) board[1][0]=2
                    else if(board[0][1] == 1 ) board[0][2]=2
                    else if (board[1][0] == 1) board[2][0]=2
                    else if(board[2][2] ==1 || board[1][2]== 1 && board[0][1]==0) board [0][1]=2
                    else if(board[2][1]==1) board[1][0]=2
                    else board[1][2]=2
                }
                else if(board[2][2]== 1) {
                    //[?,?,?],
                    //[?,2,?],
                    //[?,?,1]  
                    if(board[0][2] == 1) board[1][2]=2
                    else if(board[2][0]==1) board[2][1]=2
                    else if (board[1][2]==1) board[0][2]=2
                    else if(board[2][1]==1) board[2][0]=2
                    else if(board[0][1]==1 ) board[1][0]=2
                    else if(board[1][0]==1) board[0][1]=2 //y do they play this       
                }
                else if(board[0][2]==1) {
                    //[?,?,1],
                    //[?,2,?],
                    //[?,?,?]          
                    if(board[2][0]==1) board[0][1]=2
                    else if (board[2][1]==1) board[0][1]=2
                    else if(board[0][1]==1) board[0][0]=2
                    else if(board[1][2]==1) board[2][2]=2
                    else if(board[1][0]==1) board[0][0]=2
                }
                else if(board[2][0]==1 && board[1][0]==1) board[0][0]=2
                else if(board[0][1]==1 || board[1][2]==1 || board[1][0]==1 || board[2][1]==1) board[0][2]=2 
            }
            else if(board[1][1]==1) {
                    //[?,?,?],
                    //[?,1,?],
                    //[2,?,?] 
                    if(board[0][0]==1)board[2][2]=2
                    else if(board[0][1]==1)board[2][1]=2
                    else if(board[0][2]==1)board[0][0]=2 //why would someone chose that?
                    else if(board[1][0]==1)board[1][2]=2
                    else if(board[1][2]==1)board[1][0]=2
                    else if(board[2][1]==1)board[0][1]=2
                    else if(board[2][2]==1)board[0][0]=2
            }
        }    
    else if(round == 3) {
                if(board[1][1]==2) {//got the center       
                    //[?,?,?],
                    //[?,2,?],
                    //[?,?,?]
                    if(board[0][2]==2 && board[2][0] == 0)board[2][0]=2
                    else if(board[0][0]==2 && board[2][2]==0)board[2][2]=2
                    else if(board[1][2]==2 && board[1][0]==0) board[1][0]=2
                    else if(board[2][0]==2 && board[0][2]==0)board[0][2]=2
                    else if(board[2][2]==2 && board[0][0]==0) board[0][0]=2
                    else if(board[0][1]==2 && board[2][1]==0)board[2][1]=2
                    else if(board[1][0]==2 && board[1][2]==0)board[1][2]=2
                    else if(board[2][1]==2 && board[0][1]==0)board[0][1]=2
                    else if(board[2][0]==1 && board[1][0]==1 && board[0][0]==0)board[0][0]=2
                    else if(board[0][1]==1 && board[1][2]==1 && board[2][2]==0)board[2][2]=2
                    else {// we got the center and the user didn't let us a free win
                      
                        if(board[0][0]==1) {
                            if(board[0][2]==1 && board[0][1]==0) board[0][1]=2
                            else if(board[2][0]==1 && board[1][0]==0) board[1][0]=2
                            else if(board[0][1]==1 && board[0][2]==0) board[0][2]=2
                            else if(board[2][2]==0)board[2][2]=2                
                        }
                        if(board[2][2]==1) {
                            
                            if(board[0][2]==1 && board[1][2]==0)board[1][2]=2
                            else if(board[2][0]==1 && board[2][1]==0)board[2][1]=2
                            else if(board[2][1]==1 && board[2][0]==0)board[2][0]=2
                            else if(board[1][2]==1 && board[0][2]==0)board[0][2]=2
                            
                            else if(board[0][0]==0)board[0][0]=2
                            else if(board[0][2]==0)board[0][2]=2 
                        }
                        else if(board[2][0]==1){
                            if(board[2][1]==1 && board[2][2]==0)board[2][2]=2
                        }                      
                    }
                }
                else {  //we got no center
                    if(board[2][2]==2 && board[2][1]==0)board[2][1]=2   //check the insta win
                    else if(board[2][1]==2 && board[2][2]==0)board[2][2]=2
                    else if(board[1][0]==2 && board[0][0]==0)board[0][0]=2
                    else if(board[0][0]==2 && board[2][0]==2 && board[1][0]==0)board[1][0]=2
                    
                    else if(board[2][2]==1 && board[0][0]==0)board[0][0]=2  //block the corner attack

                    else if(board[2][1]==1 && board[0][1]==0)board[0][1]=2  //block the non-corner attacks
                    else if(board[1][0]==1 && board[1][2]==0)board[1][2]=2 
                    else if(board[0][0]==1){
                        
                        if(board[2][2]==0) board[2][2]=2
                        else if(board[0][2]==1 && board[0][1]==0)board[0][1]=2
                    }
                    else if(board[0][1]==1 && board[1][0]==1)board[2][1]=2 //what is this move?        
                }
    }
    else if(round==4) {
        
        if(board[1][1]==2){//got the center
            
            if(board[1][0]==2 && board[1][2]==0)board[1][2]=2//check for a instant win
            else if(board[0][0]==2 && board[0][1]==0 && board[0][2]==2)board[0][1]=2
            else if(board[1][0]==0 && board[1][2]==2)board[1][0]=2
            else if(board[0][1]==2 && board[2][1]==0)board[2][1]=2
            else if(board[0][1]==0 && board[2][1]==2)board[0][1]=2
            else if(board[0][2]==2 && board[2][0]==0)board[2][0]=2
            else if(board[0][2]==0 && board[2][0]==2)board[0][2]=2
            else if(board[0][2]==2 && board[2][2]==2 && board[1][2]==0)board[1][2]=2
            else if(board[2][2]==2 && board[0][0]==0)board[0][0]=2
            else if(board[0][0]==2 && board[2][2]==0)board[2][2]=2
            else if(board[0][0]==2 && board[0][2]==0)board[0][2]=2
            
            else {  //no free win
                if(board[0][2]==1 ) {
                    if(board[1][2]==1 && board[2][2]==0)board[2][2]=2
                    else if(board[2][2]==1 && board[1][2]==0)board[1][2]=2
                    else if(board[0][0]==1 && board[0][1]==0)board[0][1]=2 
                }
                if(board[0][0]==1) {
                    
                    if(board[0][1]==1 && board[0][2]==0)board[0][2]=2
                    else if(board[2][0]==0)board[2][0]=2
                    else if(board[1][0]==0 && board[2][0]==1)board[1][0]=2
                    else if(board[0][1]==0)board[0][1]=2
                    else if(board[1][0]==0 && board[2][0]==0)board[2][0]=2
                    else if(board[2][1]==0 && board[2][2]==0)board[2][2]=2
                             
                }
                if(board[2][2]==1){
                    if(board[2][0]==1 && board[2][1]==0)board[2][1]=2
                    else if(board[2][0]==0 )board[2][0]=2
                    else if(board[2][1]==0)board[2][1]=2
                }
                if(board[0][0]==0 && board[0][1]==0)board[0][0]=2
                else if(board[1][0]==0 && board[1][2]==0)board[1][0]=2    
            }
        }
        else {  //the user has the center
            if(board[0][1]==1 && board[2][1]==0) board[2][1]=2
            else if(board[2][2]==2 && board[1][2]==2 && board[0][2]==0)board[0][2]=2
            else if(board[0][0]==0 && board[2][2]==1)board[0][0]=2
            else if(board[0][1]==0 && board[2][1]==1) board[0][1]=2
            else if(board[1][0]==1 && board[1][2]==0)board[1][2]=2
            else if(board[1][0]==0 && board[1][2]==1)board[1][0]=2
            else if(board[2][2]==2 && board[2][1]==0)board[2][1]=2
            else if(board[2][0]==2 && board[2][1]==2 && board[2][2]==0)board[2][2]=2
            
            else if(board[0][1]==0) board[0][1]=2
            else if(board[1][0]==0) board[1][0]=2
        }
    }
}

function is_solved() {  //function that check the result of a game
    let answer= 0
    let empty = 0
        if (board[1][1] == 1 && board[0][0] == 1 && board[2][2] == 1 || board[1][1] == 1 && board[0][2] == 1 && board[2][0] == 1) return 1;
        if (board[1][1] == 2 && board[0][0] == 2 && board[2][2] == 2 || board[1][1] == 2 && board[0][2] == 2 && board[2][0] == 2) return 2;

        for(let x=0; x < 3; x++){
            if (board[x][0] == 1 && board[x][1] == 1 && board[x][2] == 1) return 1;
            if (board[x][0] == 2 && board[x][1] == 2 && board[x][2] == 2) return 2;
            if (board[0][x] == 1 && board[1][x] == 1 && board[2][x] == 1) return 1;
            if (board[0][x] == 2 && board[1][x] == 2 && board[2][x] == 2) return 2;        
        for(let y=0; y < 3; y++)   
    
            if (board[x][y] == 0) empty += 1;
    }
        if (empty > 0) answer =-1;
    return answer;
    }
    function theWinner() {  //function that update a pharagraph to the result of the game
        let who=is_solved()
        if(who==1) {
                document.querySelector(".winner").innerHTML = "the 'x' won";
	                document.querySelector(".winner").style.display = "block";
        }
        else if(who==2){
                document.querySelector(".winner").innerHTML = "the 'o' won";
	                document.querySelector(".winner").style.display = "block";
        }
        else if(who==0){
            document.querySelector(".winner").innerHTML = "it's a draw";
	                document.querySelector(".winner").style.display = "block";
        }
    }
   
    function updateBoard(column, row) {    // function that update the array board with the input from the user
                if(board[row][column]==0){      // check if the square is empty so that the user cant overwrite            
                    board[row][column] = 1  //we dont need to check anything because we will force the input to be correct, because we wont make the user able to overwrite squares.
                    document.querySelector(".board-error").innerHTML = "updated the board";
                    round++
                    drawBoard() //print only the new user move
                    IA(),
                     setTimeout(() => {    drawBoard() }, 200); //print the bot move after 0,2 seconds
                }     
                  
            }
        </script>
     
        <h1 style="text-align: center">Play Tic Tac Toe</h1>
        <form action="/action.php">
            
            <label for="row">Insert the row where you want to put a marker on</label> <!-- input for the row -->
                <input id="row" class="qty" type="text" placeholder="row" />
                <br> <!-- space it -->
                
            <label for="column">Insert the column where you want to put a marker on</label> <!-- input for the column -->
                <input id="column" class="qty" type="text" placeholder="column" />
                <br> <!-- space it -->
        
            <button onclick="updateBoard()">Submit</button>
           <!-- button to process the data that the user just fed us -->
        </form>

        <div>
            <input type="button" value="print" id = "button1" onclick="drawBoard();">   <!-- button to print the board -->

            <input type="button" value="botMove" id = "button2" onclick="IA();"> <!-- button to make the bot move -->
        </div>

        <table class="board" > <!-- the table that contain the board-->
            
            <tr>
                <td id="cell00"  ><img src='https://static.vecteezy.com/system/resources/previews/001/209/957/original/square-png.png' onclick='updateBoard(0, 0)' height=80 width=80 ></td>
                <td id="cell01" ><img src='https://static.vecteezy.com/system/resources/previews/001/209/957/original/square-png.png' onclick='updateBoard(1, 0)' height=80 width=80 ></td>
                <td id="cell02" ><img src='https://static.vecteezy.com/system/resources/previews/001/209/957/original/square-png.png' onclick='updateBoard(2, 0)' height=80 width=80 ></td> 
            </tr>
            <tr>
                <td id="cell10" ><img src='https://static.vecteezy.com/system/resources/previews/001/209/957/original/square-png.png' onclick='updateBoard(0, 1)' height=80 width=80 ></td>
                <td id="cell11" ><img src='https://static.vecteezy.com/system/resources/previews/001/209/957/original/square-png.png' onclick='updateBoard(1, 1)' height=80 width=80 ></td><!-- the new row starts with 10 because of the function drawboard -->
                <td id="cell12" ><img src='https://static.vecteezy.com/system/resources/previews/001/209/957/original/square-png.png' onclick='updateBoard(2, 1)' height=80 width=80 ></td>   
            </tr>
            <tr>
                <td id="cell20" ><img src='https://static.vecteezy.com/system/resources/previews/001/209/957/original/square-png.png' onclick='updateBoard(0, 2)' height=80 width=80 ></td>
                <td id="cell21" ><img src='https://static.vecteezy.com/system/resources/previews/001/209/957/original/square-png.png' onclick='updateBoard(1, 2)' height=80 width=80 ></td>
                <td id="cell22" ><img src='https://static.vecteezy.com/system/resources/previews/001/209/957/original/square-png.png' onclick='updateBoard(2, 2)' height=80 width=80 ></td>
            </tr>

        </table>
   
        <p class="board-error"></p>
        <p class="winner"></p>

    </body>
</html>
